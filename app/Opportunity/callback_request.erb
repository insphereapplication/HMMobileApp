<div data-role="page" data-theme="b" id="callback_create">
	<%= offline_bar%>
	<div data-role="header" data-theme="b" data-position="inline">
		<a href="<%=url_for(:action=>:show, :id => @opportunity.object, :query =>{:origin => @params['origin']})%>" data-direction="reverse" rel="external" data-icon="back">Cancel</a>
		<h1>Call Back <%= sync_spinner %></h1>	
	</div>
	<div id="contentDiv" data-role="content" data-theme="b">
		<div style="text-align:center" class="ui-bar"> 
			<h1><%= "#{@opportunity.contact.full_name} - #{to_date(@opportunity.createdon)}" %></h1>
		</div>
		<hr/>
		<form name="call_back_form" id="call_back_form" method="POST" action="<%= url_for :controller => :Activity, :action => :update_status_call_back_requested, :query => {:origin => @params['origin'], :appointments => @params['appointments']} %>">
			<input type="hidden" name="opportunity_id" value="<%= @opportunity.object %>" />
			<div data-role="fieldcontain">
				            	<label for="callback_datetime">Call Back Date and Time:<font color="red"> *</font></label>
								<input id="callback_datetime" type="text" class="required" name="callback_datetime" data-theme="d" readonly value="<%= $choosed['0'] %>"  onClick="PickDateCallbackChangeFocus();"></input>
							</div>
			<div data-role="fieldcontain">
				<input type="hidden" id="phone_type_selected" name="phone_type_selected" />
			    <label for="phoneList" class="select">Phone Type:</label>            
				<select name="phoneList" id="phoneList" onchange="populatePhone(this.form.phoneList);" data-theme="d">
					<% @opportunity.contact.phone_numbers.each do |type, number| %>
						<% if @opportunity.contact.cssi_preferredphone == type %>
							<option selected value="<%= number %>"><%= type %></option>
						<% else %>
							<option value="<%= number %>"><%= type %></option>
						<% end %>
					<% end %>
						<option value=''>Ad Hoc</option>
				</select>
			</div>
			<div data-role="fieldcontain">
				<label for="phoneNumber" class="fieldLabel">Phone Number: <font color="red"> *</font></label>
				<input type="tel" id="phoneNumber" name="phone_number" data-theme="d" onkeypress="if(event.keyCode==13){return false;}"/>
			</div>
			<div data-role="fieldcontain">
				<fieldset data-role="controlgroup">
   	              <legend>Priority:</legend>
	                 <input type="checkbox" name="callback_priority_checkbox" id="callback_priority_checkbox" data-theme="d" class="custom"/>
	                 <label for="callback_priority_checkbox">
	                     <img src="/public/images/red_exclamation.png" style="width: 16px; height: 16px;" />
	                     High
	                 </label>   
				</fieldset>   
            </div>
			<input type="submit" onclick="return enablePhoneNumber();" value="Create Call Back" data-theme="b"/>
		</form>
	</div>
	<script type='text/javascript'>
		$(document).delegate("#callback_create","pageinit" ,function() {
			populatePhone(document.getElementById('phoneList'));
		});

	function PickDateCallbackChangeFocus() {
	popupTomorrowDateTimeAJPicker('0', 'Callback Time', 'callback_datetime');
	document.getElementById('callback_datetime').focus();
	}
	</script>
</div>
